generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum role {
  admin
  user
}

enum itemstatus {
  Tersedia
  Disewa
}

enum orderstatus {
  Keranjang
  Tertunda
  Disewa
  Selesai
  Dibatalkan
}


model User {
  id                Int         @id @default(autoincrement())
  name              String?     @db.VarChar(100)
  username          String?     @unique @db.VarChar(100)
  email             String?     @unique @db.VarChar(100)
  password          String      @db.VarChar(100)
  phone             String?     @db.VarChar(100)
  role              role        @default(user)
  alamat            String?     @db.VarChar(255)
  image_url         String?     @db.VarChar(255)
  updated_at        DateTime?   @updatedAt @db.Timestamp(0) @map("updated_at")
  created_at        DateTime?   @default(now()) @db.Timestamp(0) @map("created_at")
  orders             Order[]
  @@map("users")
}

model Category {
    id              Int         @id @default(autoincrement())
    category_name   String      @unique @db.VarChar(100)
    updated_at      DateTime?   @updatedAt @db.Timestamp(0) @map("updated_at")
    created_at      DateTime?   @default(now()) @db.Timestamp(0) @map("created_at")
    item            Item[]
    @@map("categories")
}

model Item {
  id                Int         @id @default(autoincrement())
  category_id       Int?
  item_code         String?     @unique @db.VarChar(50)
  item_name         String?     @db.VarChar(100)
  description       String?     @db.Text
  rental_price      Int?        @db.Int
  stock             Int?        @db.Int
  status            itemstatus  @default(Tersedia)
  image_url         Json?
  updated_at        DateTime?   @updatedAt @db.Timestamp(0) @map("updated_at")
  created_at        DateTime?   @default(now()) @db.Timestamp(0) @map("created_at")
  categories        Category?   @relation(fields: [category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  details           OrderDetail[]
  @@map("items")
}

model Order {
  id                Int         @id @default(autoincrement())
  user_id           Int?
  status            orderstatus @default(Keranjang)
  subtotal          Int?        @db.Int
  updated_at        DateTime?   @updatedAt @db.Timestamp(0) @map("updated_at")
  created_at        DateTime?   @default(now()) @db.Timestamp(0) @map("created_at")
  user              User?       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  details           OrderDetail[]
  @@map("orders")
}

model OrderDetail {
  id                Int         @id @default(autoincrement())
  item_id           Int?
  order_id          Int?
  rental_date       DateTime?   @db.Date()
  rental_hour       String?
  return_date       DateTime?   @db.Date()
  return_hour       String?
  duration          Int?        @db.Int
  quantity          Int?        @db.Int
  price             Int?        @db.Int
  subtotal          Int?        @db.Int
  updated_at        DateTime?   @updatedAt @db.Timestamp(0) @map("updated_at")
  created_at        DateTime?   @default(now()) @db.Timestamp(0) @map("created_at")
  order             Order?       @relation(fields: [order_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  item              Item?       @relation(fields: [item_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  @@map("order_details")
}